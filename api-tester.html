<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Response Time Tester - Developer Toolkit | DevDunia</title>
    <meta name="description" content="Test API response times and performance. Free online API tester with detailed timing analysis for developers.">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="js/common.js"></script>
    <style>
        body {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
        }
    </style>
</head>
<body class="min-h-screen">
    <!-- Background: Consistent Subtle Dark Gradient -->
    <div class="fixed inset-0 -z-10 bg-gradient-to-br from-gray-900 via-slate-900 to-gray-900"></div>

    <!-- Main Container -->
    <div class="relative z-10 container mx-auto px-4 pt-16 pb-24 sm:px-6 lg:px-8">
        
        <!-- Page Header -->
        <div class="text-center mb-12">
            <h1 class="text-3xl sm:text-4xl font-bold mb-4 tracking-tight
                       text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-cyan-500">
                API Response Time Tester
            </h1>
            <p class="text-lg text-gray-400 max-w-2xl mx-auto">
                Test API response times and performance. Analyze request/response details with comprehensive timing metrics.
            </p>
        </div>

        <!-- Tool Container -->
        <div class="max-w-6xl mx-auto">
            <div class="bg-slate-800/70 backdrop-blur-md rounded-lg shadow-lg border border-slate-700/60 p-6">
                
                <!-- Request Configuration -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                    <!-- Left Column - Request Setup -->
                    <div class="space-y-6">
                        <div>
                            <label for="request-method" class="block text-sm font-medium text-gray-300 mb-2">
                                HTTP Method
                            </label>
                            <select id="request-method" class="w-full px-4 py-2 bg-slate-700/50 border border-slate-600 rounded-lg text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <option value="GET">GET</option>
                                <option value="POST">POST</option>
                                <option value="PUT">PUT</option>
                                <option value="PATCH">PATCH</option>
                                <option value="DELETE">DELETE</option>
                                <option value="HEAD">HEAD</option>
                                <option value="OPTIONS">OPTIONS</option>
                            </select>
                        </div>

                        <div>
                            <label for="request-url" class="block text-sm font-medium text-gray-300 mb-2">
                                URL
                            </label>
                            <input 
                                type="url" 
                                id="request-url" 
                                class="w-full px-4 py-2 bg-slate-700/50 border border-slate-600 rounded-lg text-gray-200 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                placeholder="https://api.example.com/endpoint"
                            >
                        </div>

                        <div>
                            <label for="request-headers" class="block text-sm font-medium text-gray-300 mb-2">
                                Headers (JSON)
                            </label>
                            <textarea 
                                id="request-headers" 
                                rows="4" 
                                class="w-full px-4 py-2 bg-slate-700/50 border border-slate-600 rounded-lg text-gray-200 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none font-mono text-sm"
                                placeholder='{"Content-Type": "application/json", "Authorization": "Bearer token"}'
                            ></textarea>
                        </div>

                        <div>
                            <label for="request-body" class="block text-sm font-medium text-gray-300 mb-2">
                                Request Body
                            </label>
                            <textarea 
                                id="request-body" 
                                rows="6" 
                                class="w-full px-4 py-2 bg-slate-700/50 border border-slate-600 rounded-lg text-gray-200 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none font-mono text-sm"
                                placeholder='{"key": "value"}'
                            ></textarea>
                        </div>
                    </div>

                    <!-- Right Column - Test Options -->
                    <div class="space-y-6">
                        <div>
                            <label for="test-count" class="block text-sm font-medium text-gray-300 mb-2">
                                Number of Requests
                            </label>
                            <input 
                                type="number" 
                                id="test-count" 
                                min="1" 
                                max="100" 
                                value="1"
                                class="w-full px-4 py-2 bg-slate-700/50 border border-slate-600 rounded-lg text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            >
                        </div>

                        <div>
                            <label for="delay-between" class="block text-sm font-medium text-gray-300 mb-2">
                                Delay Between Requests (ms)
                            </label>
                            <input 
                                type="number" 
                                id="delay-between" 
                                min="0" 
                                max="10000" 
                                value="0"
                                class="w-full px-4 py-2 bg-slate-700/50 border border-slate-600 rounded-lg text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            >
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">
                                Test Options
                            </label>
                            <div class="space-y-2">
                                <label class="flex items-center">
                                    <input type="checkbox" id="follow-redirects" checked class="mr-2 rounded text-blue-600 focus:ring-blue-500">
                                    <span class="text-gray-300 text-sm">Follow Redirects</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="include-timing" checked class="mr-2 rounded text-blue-600 focus:ring-blue-500">
                                    <span class="text-gray-300 text-sm">Include Detailed Timing</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="save-response" class="mr-2 rounded text-blue-600 focus:ring-blue-500">
                                    <span class="text-gray-300 text-sm">Save Response Data</span>
                                </label>
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">
                                Quick Templates
                            </label>
                            <div class="grid grid-cols-2 gap-2">
                                <button class="template-btn px-3 py-2 bg-slate-600 hover:bg-slate-700 text-white text-sm rounded transition-colors duration-200" data-template="json-api">
                                    JSON API
                                </button>
                                <button class="template-btn px-3 py-2 bg-slate-600 hover:bg-slate-700 text-white text-sm rounded transition-colors duration-200" data-template="rest-api">
                                    REST API
                                </button>
                                <button class="template-btn px-3 py-2 bg-slate-600 hover:bg-slate-700 text-white text-sm rounded transition-colors duration-200" data-template="graphql">
                                    GraphQL
                                </button>
                                <button class="template-btn px-3 py-2 bg-slate-600 hover:bg-slate-700 text-white text-sm rounded transition-colors duration-200" data-template="webhook">
                                    Webhook
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="flex flex-wrap gap-3 mb-6">
                    <button id="test-btn" class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors duration-200 flex items-center space-x-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                        </svg>
                        <span>Start Test</span>
                    </button>
                    
                    <button id="stop-btn" class="px-6 py-3 bg-red-600 hover:bg-red-700 text-white font-medium rounded-lg transition-colors duration-200 flex items-center space-x-2" disabled>
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                        <span>Stop Test</span>
                    </button>
                    
                    <button class="clear-btn px-6 py-3 bg-slate-600 hover:bg-slate-700 text-white font-medium rounded-lg transition-colors duration-200 flex items-center space-x-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                        <span>Clear All</span>
                    </button>
                </div>

                <!-- Progress Bar -->
                <div id="progress-section" class="hidden mb-6">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-sm text-gray-400">Test Progress</span>
                        <span id="progress-text" class="text-sm text-gray-400">0/0</span>
                    </div>
                    <div class="w-full bg-slate-700 rounded-full h-2">
                        <div id="progress-bar" class="bg-blue-600 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                    </div>
                </div>

                <!-- Results Section -->
                <div id="results-section" class="hidden">
                    
                    <!-- Summary Stats -->
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                        <div class="bg-slate-700/50 rounded-lg p-4 text-center">
                            <div class="text-2xl font-bold text-green-400" id="total-requests">0</div>
                            <div class="text-sm text-gray-400">Total Requests</div>
                        </div>
                        <div class="bg-slate-700/50 rounded-lg p-4 text-center">
                            <div class="text-2xl font-bold text-blue-400" id="avg-response-time">0ms</div>
                            <div class="text-sm text-gray-400">Avg Response Time</div>
                        </div>
                        <div class="bg-slate-700/50 rounded-lg p-4 text-center">
                            <div class="text-2xl font-bold text-purple-400" id="min-response-time">0ms</div>
                            <div class="text-sm text-gray-400">Min Response Time</div>
                        </div>
                        <div class="bg-slate-700/50 rounded-lg p-4 text-center">
                            <div class="text-2xl font-bold text-orange-400" id="max-response-time">0ms</div>
                            <div class="text-sm text-gray-400">Max Response Time</div>
                        </div>
                    </div>

                    <!-- Detailed Results -->
                    <div class="mb-6">
                        <h3 class="text-lg font-semibold text-blue-400 mb-3">Test Results</h3>
                        <div class="bg-slate-700/30 rounded-lg border border-slate-600/50 overflow-hidden">
                            <div class="overflow-x-auto">
                                <table class="w-full text-sm">
                                    <thead class="bg-slate-800/50">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-gray-300">#</th>
                                            <th class="px-4 py-3 text-left text-gray-300">Status</th>
                                            <th class="px-4 py-3 text-left text-gray-300">Response Time</th>
                                            <th class="px-4 py-3 text-left text-gray-300">Size</th>
                                            <th class="px-4 py-3 text-left text-gray-300">Timestamp</th>
                                        </tr>
                                    </thead>
                                    <tbody id="results-table">
                                        <!-- Results will be populated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Response Details -->
                    <div id="response-details" class="hidden">
                        <h3 class="text-lg font-semibold text-blue-400 mb-3">Response Details</h3>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">Response Headers</label>
                                <textarea 
                                    id="response-headers" 
                                    rows="8" 
                                    class="w-full px-4 py-3 bg-slate-700/50 border border-slate-600 rounded-lg text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none font-mono text-sm"
                                    readonly
                                ></textarea>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">Response Body</label>
                                <textarea 
                                    id="response-body" 
                                    rows="8" 
                                    class="w-full px-4 py-3 bg-slate-700/50 border border-slate-600 rounded-lg text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none font-mono text-sm"
                                    readonly
                                ></textarea>
                            </div>
                        </div>
                    </div>

                </div>

                <!-- Error Display -->
                <div id="error-section" class="hidden mb-6 p-4 bg-red-900/30 border border-red-600/50 rounded-lg">
                    <div class="flex items-center space-x-2">
                        <svg class="w-5 h-5 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <span class="text-red-400 font-medium">Error:</span>
                        <span id="error-message" class="text-red-300"></span>
                    </div>
                </div>

            </div>
        </div>

    </div>

    <!-- Footer -->
    <footer class="text-center text-gray-500 mt-10 pb-6">
        © 2025 DevDunia – Free Developer Tools by <a href="https://echobash.com" class="text-blue-500 hover:underline" target="_blank">echobash</a>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const testBtn = document.getElementById('test-btn');
            const stopBtn = document.getElementById('stop-btn');
            const resultsSection = document.getElementById('results-section');
            const progressSection = document.getElementById('progress-section');
            const errorSection = document.getElementById('error-section');
            const templateBtns = document.querySelectorAll('.template-btn');

            let testInProgress = false;
            let testResults = [];

            // Start test
            testBtn.addEventListener('click', async function() {
                if (testInProgress) return;

                const url = document.getElementById('request-url').value.trim();
                if (!url) {
                    showError('Please enter a URL');
                    return;
                }

                try {
                    await startTest();
                } catch (error) {
                    showError(error.message);
                }
            });

            // Stop test
            stopBtn.addEventListener('click', function() {
                stopTest();
            });

            // Template buttons
            templateBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const template = this.dataset.template;
                    loadTemplate(template);
                });
            });

            async function startTest() {
                testInProgress = true;
                testResults = [];
                
                testBtn.disabled = true;
                stopBtn.disabled = false;
                progressSection.classList.remove('hidden');
                resultsSection.classList.add('hidden');
                hideError();

                const method = document.getElementById('request-method').value;
                const url = document.getElementById('request-url').value;
                const headers = parseHeaders();
                const body = document.getElementById('request-body').value;
                const testCount = parseInt(document.getElementById('test-count').value);
                const delay = parseInt(document.getElementById('delay-between').value);

                updateProgress(0, testCount);

                for (let i = 0; i < testCount; i++) {
                    if (!testInProgress) break;

                    try {
                        const result = await makeRequest(method, url, headers, body);
                        testResults.push(result);
                        
                        updateProgress(i + 1, testCount);
                        
                        if (delay > 0 && i < testCount - 1) {
                            await new Promise(resolve => setTimeout(resolve, delay));
                        }
                    } catch (error) {
                        testResults.push({
                            index: i + 1,
                            status: 'Error',
                            responseTime: 0,
                            size: 0,
                            timestamp: new Date().toLocaleTimeString(),
                            error: error.message
                        });
                        updateProgress(i + 1, testCount);
                    }
                }

                if (testInProgress) {
                    displayResults();
                }

                testInProgress = false;
                testBtn.disabled = false;
                stopBtn.disabled = true;
            }

            function stopTest() {
                testInProgress = false;
                testBtn.disabled = false;
                stopBtn.disabled = true;
                progressSection.classList.add('hidden');
            }

            async function makeRequest(method, url, headers, body) {
                const startTime = performance.now();
                
                const options = {
                    method: method,
                    headers: headers,
                    mode: 'cors'
                };

                if (body && (method === 'POST' || method === 'PUT' || method === 'PATCH')) {
                    options.body = body;
                }

                const response = await fetch(url, options);
                const endTime = performance.now();
                const responseTime = Math.round(endTime - startTime);

                let responseBody = '';
                let responseSize = 0;

                try {
                    responseBody = await response.text();
                    responseSize = new Blob([responseBody]).size;
                } catch (error) {
                    responseBody = 'Error reading response body';
                }

                return {
                    index: testResults.length + 1,
                    status: response.status,
                    statusText: response.statusText,
                    responseTime: responseTime,
                    size: responseSize,
                    timestamp: new Date().toLocaleTimeString(),
                    headers: Object.fromEntries(response.headers.entries()),
                    body: responseBody
                };
            }

            function parseHeaders() {
                const headersText = document.getElementById('request-headers').value.trim();
                if (!headersText) return {};

                try {
                    return JSON.parse(headersText);
                } catch (error) {
                    return {};
                }
            }

            function updateProgress(current, total) {
                const percentage = (current / total) * 100;
                document.getElementById('progress-bar').style.width = percentage + '%';
                document.getElementById('progress-text').textContent = `${current}/${total}`;
            }

            function displayResults() {
                if (testResults.length === 0) return;

                // Update summary stats
                const validResults = testResults.filter(r => !r.error);
                const responseTimes = validResults.map(r => r.responseTime);
                
                document.getElementById('total-requests').textContent = testResults.length;
                document.getElementById('avg-response-time').textContent = 
                    responseTimes.length > 0 ? Math.round(responseTimes.reduce((a, b) => a + b, 0) / responseTimes.length) + 'ms' : '0ms';
                document.getElementById('min-response-time').textContent = 
                    responseTimes.length > 0 ? Math.min(...responseTimes) + 'ms' : '0ms';
                document.getElementById('max-response-time').textContent = 
                    responseTimes.length > 0 ? Math.max(...responseTimes) + 'ms' : '0ms';

                // Update results table
                const tableBody = document.getElementById('results-table');
                tableBody.innerHTML = '';

                testResults.forEach(result => {
                    const row = document.createElement('tr');
                    row.className = 'border-b border-slate-700/50 hover:bg-slate-700/30';
                    
                    const statusColor = result.error ? 'text-red-400' : 
                                      result.status >= 200 && result.status < 300 ? 'text-green-400' :
                                      result.status >= 400 ? 'text-red-400' : 'text-yellow-400';

                    row.innerHTML = `
                        <td class="px-4 py-3 text-gray-300">${result.index}</td>
                        <td class="px-4 py-3 ${statusColor}">${result.status} ${result.statusText || ''}</td>
                        <td class="px-4 py-3 text-gray-300">${result.responseTime}ms</td>
                        <td class="px-4 py-3 text-gray-300">${formatBytes(result.size)}</td>
                        <td class="px-4 py-3 text-gray-300">${result.timestamp}</td>
                    `;

                    row.addEventListener('click', () => showResponseDetails(result));
                    tableBody.appendChild(row);
                });

                resultsSection.classList.remove('hidden');
            }

            function showResponseDetails(result) {
                if (result.error) return;

                document.getElementById('response-headers').value = JSON.stringify(result.headers, null, 2);
                document.getElementById('response-body').value = result.body;
                document.getElementById('response-details').classList.remove('hidden');
            }

            function formatBytes(bytes) {
                if (bytes === 0) return '0 B';
                const k = 1024;
                const sizes = ['B', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }

            function loadTemplate(template) {
                const templates = {
                    'json-api': {
                        method: 'GET',
                        url: 'https://jsonplaceholder.typicode.com/posts/1',
                        headers: '{"Content-Type": "application/json"}',
                        body: ''
                    },
                    'rest-api': {
                        method: 'POST',
                        url: 'https://jsonplaceholder.typicode.com/posts',
                        headers: '{"Content-Type": "application/json"}',
                        body: '{"title": "Test Post", "body": "This is a test post", "userId": 1}'
                    },
                    'graphql': {
                        method: 'POST',
                        url: 'https://api.github.com/graphql',
                        headers: '{"Content-Type": "application/json", "Authorization": "Bearer YOUR_TOKEN"}',
                        body: '{"query": "{ viewer { login } }"}'
                    },
                    'webhook': {
                        method: 'POST',
                        url: 'https://webhook.site/YOUR_WEBHOOK_ID',
                        headers: '{"Content-Type": "application/json"}',
                        body: '{"event": "test", "data": {"message": "Hello World"}}'
                    }
                };

                const t = templates[template];
                if (t) {
                    document.getElementById('request-method').value = t.method;
                    document.getElementById('request-url').value = t.url;
                    document.getElementById('request-headers').value = t.headers;
                    document.getElementById('request-body').value = t.body;
                }
            }

            function showError(message) {
                document.getElementById('error-message').textContent = message;
                errorSection.classList.remove('hidden');
            }

            function hideError() {
                errorSection.classList.add('hidden');
            }

            // Example on page load
            window.addEventListener('load', () => {
                document.getElementById('request-url').value = 'https://jsonplaceholder.typicode.com/posts/1';
                document.getElementById('request-headers').value = '{"Content-Type": "application/json"}';
            });
        });
    </script>
</body>
</html>
